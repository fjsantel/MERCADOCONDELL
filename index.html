
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mercado Condell</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://api.fontshare.com/v2/css?f[]=author@400,700&display=swap" rel="stylesheet">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
    <!-- Breakpoint Markers (hidden by default) -->
    <div id="bpMarkers" class="bp-markers-container">
        <div class="bp-marker desktop">Desktop (>1200px)</div>
        <div class="bp-marker tablet">Tablet (≤1200px)</div>
        <div class="bp-marker mobile">Mobile (≤768px)</div>
        <div class="bp-marker small-mobile">Small Mobile (≤480px)</div>
        <div class="bp-marker extra-small">Extra Small (≤380px)</div>
    </div>
    
    <!-- Toggle Button (hidden by default) -->
    <button id="bpToggle" class="bp-toggle hidden" onclick="toggleBpMarkers()">BP</button>
    
    <div class="main-container">
        <!-- Header Section -->
        <header class="header">
            <div class="header-left">
                <img src="assets/Logo-02.svg" alt="Mercado Condell" class="logo-svg">
            </div>
            <div class="header-center">
                <!-- Centro del header -->
            </div>
            <div class="header-right">
                <div class="menu-container">
                    <button class="menu-button" onclick="toggleMenu()">MENÚ</button>
                    <div class="menu-dropdown" id="menuDropdown">
                        <a href="#inicio" class="menu-item">Inicio</a>
                        <a href="#tiendas" class="menu-item">Tiendas</a>
                        <a href="#actividades" class="menu-item">Actividades</a>
                        <a href="#historia" class="menu-item">Historia</a>
                        <a href="#como-llegar" class="menu-item">Cómo llegar</a>
                        <a href="#contacto" class="menu-item">Contacto</a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Map Section -->
        <section class="map-section">
            <div class="map-container">
                <img src="assets/mapa v1.svg" alt="Mapa Mercado Condell" class="map-image">
            </div>
            <!-- Map circles for small mobile -->
            <div class="map-circle circle-1">1</div>
            <div class="map-circle circle-2">2</div>
            <div class="map-circle circle-3">3</div>
            <div class="map-circle circle-4">4</div>
            <div class="map-circle circle-5">5</div>
            <div class="map-circle circle-6">6</div>
            <div class="map-circle circle-7">7</div>
            <div class="map-circle circle-8">8</div>
            <div class="map-circle circle-9">9</div>
            <div class="map-circle circle-10">10</div>
            <div class="map-circle circle-11">11</div>
            <div class="map-circle circle-12">12</div>
            <div class="map-circle circle-13">13</div>
            <div class="map-circle circle-14">14</div>
            <div class="map-circle circle-15">15</div>
            <div class="map-circle circle-16">16</div>
            <div class="map-circle circle-17">17</div>
            <div class="map-circle circle-18">18</div>
            <div class="map-circle circle-19">19</div>
            <div class="map-circle circle-20">20</div>
        </section>

        <!-- Store Information Section -->
        <section class="store-info">
            <div class="store-info-container">
                <div class="store-info-left">
                    <div class="store-number-circle" id="storeNumberCircle">1</div>
                </div>
                <div class="store-info-center">
                    <div class="store-description">
                        <p id="storeDescription">Selecciona un número en el mapa para ver la información de la tienda.</p>
                    </div>
                </div>
                <div class="store-info-right">
                    <div class="store-info-right-top">
                        <h2 class="store-name" id="storeName">MERCADO CONDELL</h2>
                    </div>
                    <div class="store-info-right-bottom">
                        <div class="category-filter-container">
                            <button id="categoryFilterBtn" class="category-filter-button" onclick="toggleCategoryFilter()">
                                FILTRAR CATEGORÍAS
                            </button>
                            <div id="categoryFilterDropdown" class="category-filter-dropdown">
                                <select id="categorySelect" onchange="filterByCategory()">
                                    <option value="">Todas las categorías</option>
                                    <option value="alimentos">Alimentos</option>
                                    <option value="ropa">Ropa</option>
                                    <option value="musica">Música</option>
                                    <option value="decoracion">Decoración</option>
                                    <option value="cultura">Cultura</option>
                                    <option value="artesanias">Artesanías</option>
                                    <option value="tecnologia">Tecnología</option>
                                    <option value="belleza">Belleza</option>
                                    <option value="juguetes">Juguetes</option>
                                    <option value="hogar">Hogar</option>
                                    <option value="servicios">Servicios</option>
                                </select>
                            </div>
                        </div>
                        <div class="social-icons">
                            <div class="social-icon"></div>
                            <div class="social-icon"></div>
                            <div class="social-icon"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Mobile layout: Circle + Title in same line -->
                <div class="mobile-header">
                    <div class="store-number-circle mobile-circle" id="storeNumberCircleMobile">1</div>
                    <h2 class="store-name mobile-title" id="storeNameMobile">MERCADO CONDELL</h2>
                </div>
                
                <!-- Mobile description and social icons -->
                <div class="mobile-content">
                    <div class="store-description mobile-description">
                        <p id="storeDescriptionMobile">Selecciona un número en el mapa para ver la información de la tienda.</p>
                    </div>
                    <div class="category-filter-container mobile-category-filter">
                        <button id="categoryFilterBtnMobile" class="category-filter-button mobile" onclick="toggleCategoryFilter()">
                            FILTRAR CATEGORÍAS
                        </button>
                        <div id="categoryFilterDropdownMobile" class="category-filter-dropdown mobile">
                            <select id="categorySelectMobile" onchange="filterByCategoryMobile()">
                                <option value="">Todas las categorías</option>
                                <option value="alimentos">Alimentos</option>
                                <option value="ropa">Ropa</option>
                                <option value="musica">Música</option>
                                <option value="decoracion">Decoración</option>
                                <option value="cultura">Cultura</option>
                                <option value="artesanias">Artesanías</option>
                                <option value="tecnologia">Tecnología</option>
                                <option value="belleza">Belleza</option>
                                <option value="juguetes">Juguetes</option>
                                <option value="hogar">Hogar</option>
                                <option value="servicios">Servicios</option>
                            </select>
                        </div>
                    </div>
                    <div class="social-icons mobile-social">
                        <div class="social-icon"></div>
                        <div class="social-icon"></div>
                        <div class="social-icon"></div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        function toggleMenu() {
            const dropdown = document.getElementById('menuDropdown');
            const button = document.querySelector('.menu-button');
            
            dropdown.classList.toggle('show');
            button.classList.toggle('active');
        }

        // Close menu when clicking outside
        document.addEventListener('click', function(event) {
            const menuContainer = document.querySelector('.menu-container');
            const dropdown = document.getElementById('menuDropdown');
            const button = document.querySelector('.menu-button');
            
            if (!menuContainer.contains(event.target)) {
                dropdown.classList.remove('show');
                button.classList.remove('active');
            }
        });

        // Toggle breakpoint markers
        function toggleBpMarkers() {
            const markers = document.getElementById('bpMarkers');
            const button = document.getElementById('bpToggle');
            
            markers.classList.toggle('show');
            button.classList.toggle('active');
        }

        // Store data with categories
        const storeData = {
            1: {
                name: "CAFÉ MERCADO",
                category: "alimentos",
                description: "Acogedora cafetería especializada en café de especialidad y repostería artesanal. Ideal para comenzar el día o tomar un descanso con productos frescos y de origen local."
            },
            2: {
                name: "DELICIAS DEL MAR",
                category: "alimentos",
                description: "Restaurante de mariscos frescos que ofrece lo mejor de la costa chilena. Especialidad en ceviches, empanadas de mariscos y pescados a la plancha con vista al mercado."
            },
            3: {
                name: "FRUTAS Y VERDURAS EL HUERTO",
                category: "alimentos",
                description: "Puesto de frutas y verduras frescas seleccionadas diariamente desde los mejores campos de la región. Productos orgánicos y de temporada a precios accesibles."
            },
            4: {
                name: "CARNES SELECTAS DON JOSÉ",
                category: "alimentos",
                description: "Carnicería tradicional con más de 30 años de experiencia. Ofrece cortes premium, embutidos caseros y preparaciones especiales para asados y ocasiones especiales."
            },
            5: {
                name: "PANADERÍA ARTESANAL",
                category: "alimentos",
                description: "Pan recién horneado cada mañana con recetas tradicionales y técnicas artesanales. Especialidad en pan amasado, sopaipillas y empanadas horneadas."
            },
            6: {
                name: "ESPECIAS DEL MUNDO",
                category: "alimentos",
                description: "Tienda especializada en especias, hierbas y condimentos de todas partes del mundo. Productos únicos para dar sabor auténtico a tus preparaciones culinarias."
            },
            7: {
                name: "LÁCTEOS LA GRANJA",
                category: "alimentos",
                description: "Productos lácteos frescos directamente desde productores locales. Quesos artesanales, leche fresca, mantequilla y yogures naturales sin aditivos artificiales."
            },
            8: {
                name: "FLORES Y PLANTAS JARDÍN",
                category: "decoracion",
                description: "Floristería con gran variedad de flores frescas y plantas ornamentales. Arreglos para ocasiones especiales y asesoría en jardinería doméstica."
            },
            9: {
                name: "ROPA Y ACCESORIOS ESTILO",
                category: "ropa",
                description: "Boutique de moda con prendas casuales y elegantes para toda la familia. Accesorios únicos y ropa de diseñadores locales con estilo contemporáneo."
            },
            10: {
                name: "LIBRERÍA Y PAPELERÍA CULTURAL",
                category: "cultura",
                description: "Espacio dedicado a la cultura con libros, revistas, material de oficina y artículos de papelería. Punto de encuentro para amantes de la lectura y la escritura."
            },
            11: {
                name: "JUGOS NATURALES VITA",
                category: "alimentos",
                description: "Bar de jugos y batidos naturales preparados al momento con frutas frescas. Opciones detox, energizantes y smoothies nutritivos para una vida saludable."
            },
            12: {
                name: "ARTESANÍAS LOCALES",
                category: "artesanias",
                description: "Exposición y venta de artesanías tradicionales chilenas realizadas por artesanos locales. Productos únicos que reflejan la cultura y tradición de nuestra región."
            },
            13: {
                name: "ELECTRÓNICOS TECH STORE",
                category: "tecnologia",
                description: "Tienda de tecnología con los últimos dispositivos, accesorios y servicio técnico especializado. Atención personalizada y garantía en todos los productos."
            },
            14: {
                name: "PERFUMERÍA ESENCIA",
                category: "belleza",
                description: "Productos de belleza y cuidado personal de marcas reconocidas. Perfumes, cosméticos y tratamientos para el cuidado de la piel con asesoría especializada."
            },
            15: {
                name: "JUGUETERÍA FANTASÍA",
                category: "juguetes",
                description: "Mundo mágico lleno de juguetes educativos, didácticos y de entretenimiento para niños de todas las edades. Productos que estimulan la creatividad y el aprendizaje."
            },
            16: {
                name: "FERRETERÍA EL MARTILLO",
                category: "hogar",
                description: "Herramientas, materiales de construcción y artículos para el hogar. Todo lo necesario para reparaciones domésticas y proyectos de mejoramiento del hogar."
            },
            17: {
                name: "ANTIGÜEDADES Y VINTAGE",
                category: "decoracion",
                description: "Colección de objetos antiguos, muebles vintage y artículos de colección. Tesoros únicos con historia que agregan carácter especial a cualquier espacio."
            },
            18: {
                name: "COMIDA INTERNACIONAL",
                category: "alimentos",
                description: "Restaurante que ofrece sabores del mundo con platos típicos de diferentes culturas. Fusión gastronómica que celebra la diversidad culinaria internacional."
            },
            19: {
                name: "SERVICIOS GENERALES",
                category: "servicios",
                description: "Centro de servicios múltiples que incluye cobro de cuentas, envío de encomiendas, fotocopias y trámites diversos. Soluciones prácticas para el día a día."
            },
            20: {
                name: "MERCADO NOCTURNO",
                category: "musica",
                description: "Espacio gastronómico que cobra vida al atardecer con food trucks, música en vivo y ambiente bohemio. Ideal para disfrutar de la noche con sabores únicos y entretenimiento."
            }
        };

        // Category names in Spanish
        const categoryNames = {
            'alimentos': 'Alimentos',
            'ropa': 'Ropa',
            'musica': 'Música',
            'decoracion': 'Decoración',
            'cultura': 'Cultura',
            'artesanias': 'Artesanías',
            'tecnologia': 'Tecnología',
            'belleza': 'Belleza',
            'juguetes': 'Juguetes',
            'hogar': 'Hogar',
            'servicios': 'Servicios'
        };

        // Function to update store information
        function updateStoreInfo(storeNumber) {
            const store = storeData[storeNumber];
            if (!store) return;

            // Update desktop version
            document.getElementById('storeNumberCircle').textContent = storeNumber;
            document.getElementById('storeName').textContent = store.name;
            document.getElementById('storeDescription').textContent = store.description;

            // Update mobile version
            document.getElementById('storeNumberCircleMobile').textContent = storeNumber;
            document.getElementById('storeNameMobile').textContent = store.name;
            document.getElementById('storeDescriptionMobile').textContent = store.description;
        }

        // Function to toggle category filter dropdown
        function toggleCategoryFilter() {
            const dropdown = document.getElementById('categoryFilterDropdown');
            const dropdownMobile = document.getElementById('categoryFilterDropdownMobile');
            const button = document.getElementById('categoryFilterBtn');
            const buttonMobile = document.getElementById('categoryFilterBtnMobile');
            
            // Toggle desktop dropdown
            if (dropdown) {
                dropdown.classList.toggle('show');
                if (button) {
                    button.classList.toggle('active');
                }
            }
            
            // Toggle mobile dropdown
            if (dropdownMobile) {
                dropdownMobile.classList.toggle('show');
                if (buttonMobile) {
                    buttonMobile.classList.toggle('active');
                }
            }
        }

        // Function to filter by category (desktop)
        function filterByCategory() {
            const selectedCategory = document.getElementById('categorySelect').value;
            performCategoryFilter(selectedCategory);
            
            // Hide dropdown after selection
            hideCategoryDropdown();
        }

        // Function to filter by category (mobile)
        function filterByCategoryMobile() {
            const selectedCategory = document.getElementById('categorySelectMobile').value;
            performCategoryFilter(selectedCategory);
            
            // Sync both selects
            document.getElementById('categorySelect').value = selectedCategory;
            
            // Hide dropdown after selection
            hideCategoryDropdown();
        }

        // Function to hide category dropdown
        function hideCategoryDropdown() {
            const dropdown = document.getElementById('categoryFilterDropdown');
            const dropdownMobile = document.getElementById('categoryFilterDropdownMobile');
            const button = document.getElementById('categoryFilterBtn');
            const buttonMobile = document.getElementById('categoryFilterBtnMobile');
            
            if (dropdown) {
                dropdown.classList.remove('show');
            }
            if (dropdownMobile) {
                dropdownMobile.classList.remove('show');
            }
            if (button) {
                button.classList.remove('active');
            }
            if (buttonMobile) {
                buttonMobile.classList.remove('active');
            }
        }

        // Function to perform category filtering
        function performCategoryFilter(selectedCategory) {
            const circles = document.querySelectorAll('.map-circle');
            
            // Remove all category highlights first
            circles.forEach(circle => {
                circle.classList.remove('category-highlight');
            });

            if (selectedCategory === '') {
                // Show all stores normally
                updateStoreInfo(1);
                document.getElementById('storeNumberCircle').textContent = '1';
                document.getElementById('storeName').textContent = 'MERCADO CONDELL';
                document.getElementById('storeDescription').textContent = 'Selecciona un número en el mapa para ver la información de la tienda.';
                
                // Mobile version
                document.getElementById('storeNumberCircleMobile').textContent = '1';
                document.getElementById('storeNameMobile').textContent = 'MERCADO CONDELL';
                document.getElementById('storeDescriptionMobile').textContent = 'Selecciona un número en el mapa para ver la información de la tienda.';
                return;
            }

            // Find stores that match the category
            const matchingStores = [];
            const storeNames = [];
            
            for (let storeNumber in storeData) {
                const store = storeData[storeNumber];
                if (store.category === selectedCategory) {
                    matchingStores.push(storeNumber);
                    storeNames.push(`${storeNumber}. ${store.name}`);
                    
                    // Highlight matching circles
                    const circle = document.querySelector(`.map-circle.circle-${storeNumber}`);
                    if (circle) {
                        circle.classList.add('category-highlight');
                    }
                }
            }

            // Update display with category results
            const categoryDisplayName = categoryNames[selectedCategory] || selectedCategory;
            const storeListText = storeNames.join(', ');
            const resultText = `Categoría: ${categoryDisplayName}\\n\\nTiendas encontradas: ${storeListText}`;

            // Update desktop version
            document.getElementById('storeNumberCircle').textContent = matchingStores.length;
            document.getElementById('storeName').textContent = categoryDisplayName.toUpperCase();
            document.getElementById('storeDescription').textContent = resultText;

            // Update mobile version
            document.getElementById('storeNumberCircleMobile').textContent = matchingStores.length;
            document.getElementById('storeNameMobile').textContent = categoryDisplayName.toUpperCase();
            document.getElementById('storeDescriptionMobile').textContent = resultText;
        }

        // Add event listeners to all circles for all versions
        document.addEventListener('DOMContentLoaded', function() {
            const circles = document.querySelectorAll('.map-circle');
            let isTouchDevice = false;
            let selectedStore = 1; // Track the currently selected store

            // Detect if it's a touch device
            window.addEventListener('touchstart', function() {
                isTouchDevice = true;
            }, { once: true });
            
            circles.forEach(circle => {
                const storeNumber = parseInt(circle.textContent);
                
                // Mouse events for desktop and tablet (hover effects only)
                circle.addEventListener('mouseenter', () => {
                    if (!isTouchDevice) {
                        // Show hover info but don't change selection
                        updateStoreInfo(storeNumber);
                        circle.classList.add('hover');
                    }
                });

                // Mouse leave for desktop - return to selected store
                circle.addEventListener('mouseleave', () => {
                    if (!isTouchDevice) {
                        circle.classList.remove('hover');
                        // Return to the currently selected store
                        updateStoreInfo(selectedStore);
                    }
                });
                
                // Click events for all devices - this changes the selection
                circle.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Update the selected store
                    selectedStore = storeNumber;
                    
                    // Remove active class from all circles
                    circles.forEach(c => {
                        c.classList.remove('active');
                        c.classList.remove('hover');
                    });
                    
                    // Add active class to clicked circle
                    circle.classList.add('active');
                    updateStoreInfo(storeNumber);
                });

                // Touch events for mobile devices - enhanced for better touch support
                circle.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Mark as touch device
                    isTouchDevice = true;
                    
                    // Update the selected store
                    selectedStore = storeNumber;
                    
                    // Remove active class from all circles
                    circles.forEach(c => {
                        c.classList.remove('active');
                        c.classList.remove('hover');
                    });
                    
                    // Add active class to touched circle
                    circle.classList.add('active');
                    updateStoreInfo(storeNumber);
                });
                
                // Touch end event to prevent conflicts
                circle.addEventListener('touchend', (e) => {
                    e.preventDefault();
                });
            });

            // Initialize with store 1 and mark it as active
            selectedStore = 1;
            updateStoreInfo(1);
            document.querySelector('.map-circle.circle-1').classList.add('active');

            // Close category dropdown when clicking outside
            document.addEventListener('click', function(event) {
                const categoryContainer = document.querySelectorAll('.category-filter-container');
                let isInsideCategory = false;
                
                categoryContainer.forEach(container => {
                    if (container.contains(event.target)) {
                        isInsideCategory = true;
                    }
                });
                
                if (!isInsideCategory) {
                    hideCategoryDropdown();
                }
            });
        });
    </script>
    
    <script>
        if (window.netlifyIdentity) {
            window.netlifyIdentity.on("init", user => {
                if (!user) {
                    window.netlifyIdentity.on("login", () => {
                        document.location.href = "/admin/";
                    });
                }
            });
        }
    </script>
</body>
</html>